name: Extract object id

on:
  workflow_dispatch:
    inputs:
      login:
        type: text
        description: Login email
  
jobs:
  get-id:
    environment: SBX
    name: Get object ID
    runs-on: ubuntu-latest
    
    steps:
      - name: Azure Login
        uses: Azure/login@v1.4.3
        with:
          creds: ${{ secrets.AZURE_CREDS }}
          enable-AzPSSession: true
          
      - name: Azure PowerShell Action
        uses: Azure/powershell@v1
        with:
          inlineScript: |
            $objectId = (Get-AzADUser -UserPrincipalName ${{ github.event.inputs.login }}).Id
            echo $objectId
            echo "::set-output name=OBJECT_ID::$objectId"
          azPSVersion: latest
        id: object_id

      - name: Read objectId
        run: echo ${{ steps.object_id.outputs.OBJECT_ID }}
